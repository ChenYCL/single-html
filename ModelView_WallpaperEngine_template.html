<!DOCTYPE html>
<meta name="viewport" content="user-scalable=0"/>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<html>
<head>
    <title>ModelView</title>
    <!--    lib-->
    <script desc="lib-js">
        <%= htmlWebpackPlugin.options.templateParameters.myscript %>
    </script>
    <!--    data,image,model-->
    <script desc="model-data">
        <%= htmlWebpackPlugin.options.templateParameters.model_base64_data %>
    </script>
</head>
<body>
	<div id="view"></div>
    <script>
        const b64toBlob = (b64Data, contentType = "", sliceSize = 512) => {
            const byteCharacters = atob(b64Data);
            const byteArrays = [];

            for (let offset = 0; offset < byteCharacters.length; offset += sliceSize) {
                const slice = byteCharacters.slice(offset, offset + sliceSize);

                const byteNumbers = new Array(slice.length);
                for (let i = 0; i < slice.length; i++) {
                    byteNumbers[i] = slice.charCodeAt(i);
                }

                const byteArray = new Uint8Array(byteNumbers);
                byteArrays.push(byteArray);
            }

            const blob = new Blob(byteArrays, {
                type: contentType,
            });
            return blob;
        };
        const contentType = "application/octet-stream";
		function getModelURL(model) {return URL.createObjectURL(b64toBlob(model, contentType));}
        const blobUrl = getModelURL(sceneModel); 
		marmoset.noUserInterface = true; //please be considerate
        setTimeout(function() {
            var myviewer = new marmoset.WebViewer(window.innerWidth, window.innerHeight, blobUrl);
            document.getElementById("view").appendChild(myviewer.domRoot);
			myviewer.domRoot.style.position = "absolute", myviewer.domRoot.style.left = myviewer.domRoot.style.top = 0;
            myviewer.loadScene();
        }, 300);
        setTimeout(function() {
		document.getElementById('marmosetUI').addEventListener('mousemove', function(){console.log('BlockMousemove');this.outerHTML = this.outerHTML;}, false);
		document.getElementById('marmosetUI').addEventListener('mousewheel', function(){console.log('BlockMousewheel');this.outerHTML = this.outerHTML;}, false);
		document.getElementById('marmosetUI').addEventListener('wheel', function(){console.log('Blockwheel');this.outerHTML = this.outerHTML;}, false);
		document.getElementById('marmosetUI').addEventListener('touchstart', function(){console.log('BlockTouchstart');this.outerHTML = this.outerHTML;}, false);
		document.getElementById('marmosetUI').addEventListener('touchmove', function(){console.log('BlockTouchmove');this.outerHTML = this.outerHTML;}, false);
		}, 400);

    </script>

</body>
</html>
